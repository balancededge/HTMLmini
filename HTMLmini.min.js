function HTMLmini(){HTMLmini.file="@",HTMLmini.html=function(a,b){return HTMLmini.Compiler.html(a,b)},HTMLmini.stringify=function(a){return HTMLmini.Compiler.stringify(a)},HTMLmini.minify=function(a){return HTMLmini.Compiler.minify(a)},HTMLmini.compile=function(a){return HTMLmini.Compiler.compile(a)},HTMLmini.debug=function(a){console.log(JSON.stringify(a,null,4))},HTMLmini.throw=function(a,b,c,d){if(void 0!=c&&void 0!=d)throw new HTMLmini.Exception(a+"Exception",b+" "+HTMLmini.file+":"+c+":"+d);throw new HTMLmini.Exception(a+"Exception",b+" "+HTMLmini.file)},HTMLmini.Exception=function(a,b){this.name=a,this.message=a+": "+b}}HTMLmini.Compiler=new function(){this.html=function(a,b){return HTMLmini.Generator.html(this.compile(a),b)},this.stringify=function(a){return HTMLmini.Generator.stringify(this.compile(a))},this.minify=function(a){return HTMLmini.Generator.minify(this.compile(a))},this.compile=function(a){return HTMLmini.Parser.parse(HTMLmini.Lexer.lex(a))}},HTMLmini.Generator=new function(){this.html=function(a,b){void 0==b&&(b=!1);var c=[];for(var d in a){var e=a[d],f=this.html(e.child,!0);if(void 0!=e.tag){var g=document.createElement(e.tag);void 0!=e.id&&g.setAttribute("id",e.id);for(attr in e.attr)g.setAttribute(attr,e.attr[attr]);e.class.length>0&&g.setAttribute("class",e.class.join(" ")),void 0!=e.text&&g.appendChild(document.createTextNode(e.text));for(var h in f)g.appendChild(f[h]);c.push(g)}else c.push(document.createTextNode(e.text))}return b?c:c.shift()},this.stringify=function(a){var b="";for(var c in a){var d=a[c],e=this.indent(d.indent);if(void 0!=d.tag){b+=e+"<"+d.tag,void 0!=d.id&&(b+=' id="'+d.id+'"');for(attr in d.attr)b+=" "+attr+(d.attr[attr].length>0?'="'+d.attr[attr]+'"':"");d.class.length>0&&(b+=' class="'+d.class.join(" ")+'"'),b+=">",void 0!=d.text&&(b+=this.escape(d.text)),d.child.length>0?b+="\n"+this.stringify(d.child)+e:void 0!=d.text&&d.text.indexOf("\n")>-1&&(b+="\n"+e),b+="</"+d.tag+">\n"}else b+=e+this.escape(d.text)+"\n"}return b.replace("<br></br>","<br>").replace("<hr></hr>","<hr>").replace("</link>","")},this.minify=function(a){var b="";for(var c in a){var d=a[c];if(void 0!=d.tag){b+="<"+d.tag,void 0!=d.id&&(b+=' id="'+d.id+'"');for(attr in d.attr)b+=" "+attr+(d.attr[attr].length>0?'="'+d.attr[attr]+'"':"");d.class.length>0&&(b+=' class="'+d.class.join(" ")+'"'),b+=">",void 0!=d.text&&(b+=this.escape(d.text)),d.child.length>0&&(b+=this.minify(d.child)),b+="</"+d.tag+">"}else b+=this.escape(d.text)}return b.replace("<br></br>","<br>").replace("<hr></hr>","<hr>").replace("</link>","")},this.indent=function(a){for(var b="";b.length<a;)b+=" ";return b},this.escape=function(a){return a.replace(/[^0-9A-Za-z ]/g,function(a){return"&#"+a.charCodeAt(0)+";"})}},HTMLmini.Lexer=new function(){this.tokens={comment:/(\n *#.*)|(# .*)/,newline:/\n/,newinline:/>/,whitespace:/\s/,attrl:/\[ */,attrr:/\] */,text:/\| */,tag:/(\w|-)+ */,id:/#(\w|-)+ */,class:/\.(\w|-)+ */,string:/("([^"\\]|\\.)*")|('([^'\\]|\\.)*') */},this.lex=function(a,b){return this.tokenize(this.template(this.preprocess(a),b))},this.preprocess=function(a){return("\n"+a+"\n").replace(/\t/g,"    ").replace(/\r\n|\r|\n/g,"\n")},this.template=function(a,b){for(var c in b)a=a.replace(new RegExp("[^\\](\\\\)*:"+c,"g"),function(a){return a.replace(":"+c,b[c])});return a},this.tokenize=function(a){var b=a.split("\n").length,c=a.length,d=[];a:for(;a.length>0;){var e=b-a.split("\n").length,f=c-a.length;for(var g in this.tokens)if(this.match(a,g)){d.push({name:g,source:this.tokens[g].exec(a)[0].trim(),line:e,char:f}),a=a.replace(this.tokens[g],"");continue a}HTMLmini.throw("Lexer","unknown character sequence: "+this.hint(a),e,f)}return d},this.match=function(a,b){var c=/^/.source,d=/(.|\s)*/.source;return new RegExp(c+"("+this.tokens[b].source+")"+d).test(a)},this.hint=function(a){return a.substring(0,10).trim()+"..."}},HTMLmini.Parser=new function(){this.parse=function(a){return this.walk(this.elementalize(a))},this.elementalize=function(a){this.elements=[],this.element=new this.Element,this.inattr=!1,this.intext=!1,this.attr=void 0;for(var b in a){var c=a[b];void 0==this[c.name]&&HTMLmini.throw("Parser","malformed token "+c.name,c.line,c.char),this[c.name](c)}return this.elements},this.Element=function(){this.indent=0,this.attr={},this.class=[],this.child=[]},this.newline=function(a){void 0==this.element.tag&&(Object.keys(this.element.attr).length>0||this.element.class.length>0)&&(this.element.tag="div"),void 0==this.element.tag&&void 0==this.element.text||this.elements.push(this.element),this.element=new this.Element,this.inattr=!1,this.intext=!1,this.attr=void 0},this.newinline=function(a){this.newline(),this.elements.length>0&&(this.element.indent=this.elements[this.elements.length-1].indent)},this.whitespace=function(a){this.element.indent++},this.attrl=function(a){this.intext&&HTMLmini.throw("Parser","cannot define attributes in text",a.line,a.char),this.inattr=!0},this.attrr=function(a){this.intext?HTMLmini.throw("Parser","cannot define attributes in text",a.line,a.char):void 0!=this.attr&&(this.element.attr[this.attr]="",this.attr=void 0),this.inattr=!1},this.text=function(a){this.inattr&&HTMLmini.throw("Parser","cannot define text in attributes",a.line,a.char),this.intext=!0},this.tag=function(a){this.inattr&&void 0==this.attr?this.attr=a.source:this.inattr?(this.element.attr[this.attr]="",this.attr=a.source):this.intext&&void 0!=this.element.text?this.element.text+=" "+a.source:this.intext?this.element.text=a.source:void 0==this.element.tag?this.element.tag=a.source:HTMLmini.throw("Parser","cannot redefine tag: "+this.element.tag,a.line,a.char)},this.id=function(a){void 0!=this.element.id?HTMLmini.throw("Parser","cannot redefine id: "+this.element.id,a.line,a.char):this.inattr?HTMLmini.throw("Parser","cannot define id in attributes: "+a.source,a.line,a.char):this.intext||(this.element.id=a.source.substring(1))},this.class=function(a){this.inattr?HTMLmini.throw("Parser","cannot define class in attributes: "+source,a.line,a.char):this.intext?this.element.text=a.source:this.element.class.push(a.source.substring(1))},this.string=function(a){this.inattr&&void 0!=this.attr?(this.element.attr[this.attr]=this.escape(a.source),this.attr=void 0):this.intext?this.element.text=this.escape(a.source):void 0!=this.element.tag||this.inattr?HTMLmini.throw("Parser","unexpected string "+a.source,a.line,a.char):this.element.text=this.escape(a.source)},this.comment=function(a){},this.walk=function(a){var b=a.shift();if(void 0==b)return[];for(var c=[b],d=c,e=[],f=b.indent;a.length>0;)if(b=a.shift(),b.indent==f)d.push(b);else if(b.indent>f)e.push({current:d,indent:f}),d=d[d.length-1].child,f=b.indent,d.push(b);else if(b.indent<f){0==e.length&&HTMLmini.throw("Parser","invalid tree structure");var g=e.pop();d=g.current,f=g.indent,a.unshift(b)}return c},this.escape=function(a){return a=a.replace(/"\n/g,'"').replace(/'\n/g,"'").replace(/\n"/g,'"').replace(/\n'/g,"'"),a.startsWith('"')?(a=a.replace(/\\"/g,'"'),a.endsWith('"')?a.substring(1,a.length-1).replace(/\\\\/g,"\\"):a.substring(1).replace(/\\\\/g,"\\")):(a=a.replace(/\\\'/g,"'"),a.endsWith("'")?a.substring(1,a.length-1).replace(/\\\\/g,"\\"):a.substring(1).replace(/\\\\/g,"\\"))}};HTMLmini();